{
    "name": "iceberg-sink-connector",
    "config": {
        "connector.class": "org.apache.iceberg.kafka.connect.IcebergSinkConnector",
        "task.max": "1",
        "topics": "lakehouse.trips, lakehouse.payment_types, lakehouse.vendors",

        "iceberg.catalog.uri": "http://nessie:19120/api/v2",
        "iceberg.catalog.ref": "main",
        "iceberg.catalog.warehouse": "s3://lakehouse/warehouse",
        "iceberg.catalog.catalog-impl": "org.apache.iceberg.nessie.NessieCatalog",
        "iceberg.catalog.s3.endpoint": "http://minio:9000",
        "iceberg.catalog.s3.access-key-id": "admin",
        "iceberg.catalog.s3.secret-access-key": "password",
        "iceberg.catalog.s3.path-style-access": "true",
        "iceberg.catalog.io-impl": "org.apache.iceberg.aws.s3.S3FileIO",

        "iceberg.table.namespace": "taxi_cdc",
        "iceberg.table.write-format": "parquet",
        "iceberg.table.auto-create-enabled": "false",

        "key.converter": "org.apache.kafka.connect.json.JsonConverter",
        "value.converter": "org.apache.kafka.connect.json.JsonConverter",
        "key.converter.schemas.enable": "false",
        "value.converter.schemas.enable": "false",

        "transforms": "unwrap,route",
        "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState",
        "transforms.unwrap.drop.tombstones": "false",
        "transforms.unwrap.delete.handling.mode": "rewrite",
        "transforms.unwrap.add.fields": "op:__op,source.ts_ms:__source_ts_ms,source.db:__source_db,source.table:__source_table",
        "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
        "transforms.route.regex": "lakehouse\\.([^.]+)",
        "transforms.route.replacement": "taxi_cdc.$1",

        "iceberg.tables": "taxi_cdc.trips,taxi_cdc.payment_types,taxi_cdc.vendors",
        "errors.tolerance": "all",
        "errors.log.enable": "true",
        "errors.log.include.messages": "true"
    }
}